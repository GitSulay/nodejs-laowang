名称：构建和推送Docker镜像: Build and Push Docker Image

在::
  推送::
    分支: [ main ]: [ main ]
    路径::
      - 'Dockerfile''Dockerfile'
      - 'index.js''index.js'
      - 'package.json''package.json'
  拉取请求::
    分支: [ main ]: [ main ]
  工作流_派送::

职位::
  构建::
    运行于: ubuntu-latest: ubuntu-latest
    权限：:
      内容：阅读: read
      软件包：编写: write

    步骤：:
      - 名称: 检出仓库name: Checkout repository
        用途：actions/checkout@v4: actions/checkout@v4

      - 名称：登录 GitHub 容器注册表name: Log in to GitHub Container Registry
        用途: docker/login-action@v3: docker/login-action@v3
        与：:
          注册表：ghcr.io: ghcr.io
          用户名: ${{ github.actor }}: ${{ github.actor }}
          密码: ${{ secrets.GITHUB_TOKEN }}: ${{ secrets.GITHUB_TOKEN }}

      - name: 设置Docker Buildxname: Set up Docker Buildx
        用途: docker/setup-buildx-action@v3: docker/setup-buildx-action@v3

      - name: 构建并推送Docker镜像name: Build and push Docker image
        用途: docker/build-push-action@v5: docker/build-push-action@v5
        with:
          context: .
          push: true
          platforms: linux/amd64,linux/arm64
          tags: |
            ghcr.io/${{ github.repository_owner }}/woniu:20260119
          labels: |
            org.opencontainers.image.source=https://github.com/${{ github.repository }}
            org.opencontainers.image.description=HTTP Server
            org.opencontainers.image.licenses=MIT
          cache-from: type=gha
          cache-to: type=gha,mode=max
